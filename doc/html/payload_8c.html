<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>CDI SDK: src/cdi/payload.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="image_left.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CDI SDK
   </div>
   <div id="projectbrief">SDK for transporting chunks of data reliably and with low latency using a polled mode network driver.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_440858bc2ff41f5ef15b020e90223871.html">cdi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">payload.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains internal definitions and implementation used for payloads.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="payload_8h_source.html">payload.h</a>&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="adapter__api_8h_source.html">adapter_api.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="internal_8h_source.html">internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="private_8h_source.html">private.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCdiPacketizerState.html">CdiPacketizerState</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to store the current state of a packet being constructed. Its purpose is to allow for the suspension of the creation of a packet if a pool from which items need to be allocated is empty. A state object is passed in to <a class="el" href="payload_8c.html#a6e09a3c16d4bbe498e66b10a66b7c4e2">CdiPayloadInit()</a> prior to calls to <a class="el" href="payload_8c.html#a725e7ad79003354c13854e0c21e30767">CdiPayloadParseCDIPacket()</a> for a given payload.  <a href="structCdiPacketizerState.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e09a3c16d4bbe498e66b10a66b7c4e2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="payload_8c.html#a6e09a3c16d4bbe498e66b10a66b7c4e2">CdiPayloadInit</a> (<a class="el" href="structCdiConnectionState.html">CdiConnectionState</a> *con_state_ptr, const <a class="el" href="structCdiSgList.html">CdiSgList</a> *source_sgl_ptr, <a class="el" href="structTxPayloadState.html">TxPayloadState</a> *payload_state_ptr)</td></tr>
<tr class="separator:a6e09a3c16d4bbe498e66b10a66b7c4e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ac444188a2b98dc6068200ef20f6fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="payload_8c.html#a81ac444188a2b98dc6068200ef20f6fa">CdiPacketizerStateCreate</a> ()</td></tr>
<tr class="separator:a81ac444188a2b98dc6068200ef20f6fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c20160117b8c29bba9d0310bb5dcf66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="payload_8c.html#a3c20160117b8c29bba9d0310bb5dcf66">CdiPacketizerStateInit</a> (<a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> packetizer_state_handle)</td></tr>
<tr class="separator:a3c20160117b8c29bba9d0310bb5dcf66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8434d7c6a3ba6e65e9b6d074daa0d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="payload_8c.html#a9d8434d7c6a3ba6e65e9b6d074daa0d7">CdiPacketizerStateDestroy</a> (<a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> packetizer_state_handle)</td></tr>
<tr class="separator:a9d8434d7c6a3ba6e65e9b6d074daa0d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaef1dc8535f2f1dcddbd4ba0dd18b02"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="payload_8c.html#afaef1dc8535f2f1dcddbd4ba0dd18b02">CdiPayloadGetPacket</a> (<a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> packetizer_state_handle, <a class="el" href="structCdiCDIPacketHeaderUnion.html">CdiCDIPacketHeaderUnion</a> *hdr_union_ptr, <a class="el" href="cdi__pool__api_8h.html#a8e5912d6ac4676dac0adfb54cada3e03">CdiPoolHandle</a> packet_sgl_entry_pool_handle, <a class="el" href="structTxPayloadState.html">TxPayloadState</a> *payload_state_ptr, <a class="el" href="structCdiSgList.html">CdiSgList</a> *packet_sgl_ptr, bool *ret_is_last_packet_ptr)</td></tr>
<tr class="separator:afaef1dc8535f2f1dcddbd4ba0dd18b02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725e7ad79003354c13854e0c21e30767"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structCdiCDIPacketCommonHeader.html">CdiCDIPacketCommonHeader</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="payload_8c.html#a725e7ad79003354c13854e0c21e30767">CdiPayloadParseCDIPacket</a> (const <a class="el" href="structCdiSgList.html">CdiSgList</a> *packet_sgl_ptr)</td></tr>
<tr class="separator:a725e7ad79003354c13854e0c21e30767"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains internal definitions and implementation used for payloads. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a81ac444188a2b98dc6068200ef20f6fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ac444188a2b98dc6068200ef20f6fa">&#9670;&nbsp;</a></span>CdiPacketizerStateCreate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a> CdiPacketizerStateCreate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a packetizer state object. This must be destroyed with <a class="el" href="payload_8h.html#a9d8434d7c6a3ba6e65e9b6d074daa0d7">CdiPacketizerStateDestroy()</a> when the connection is closed.</p>
<dl class="section return"><dt>Returns</dt><dd>Handle for the created packetizer state or NULL if the creation failed. </dd></dl>

</div>
</div>
<a id="a9d8434d7c6a3ba6e65e9b6d074daa0d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8434d7c6a3ba6e65e9b6d074daa0d7">&#9670;&nbsp;</a></span>CdiPacketizerStateDestroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CdiPacketizerStateDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a>&#160;</td>
          <td class="paramname"><em>packetizer_state_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory previously allocated for a packetizer state object through <a class="el" href="payload_8h.html#a81ac444188a2b98dc6068200ef20f6fa">CdiPacketizerStateCreate()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetizer_state_handle</td><td>The handle of the packetizer state to be destroyed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3c20160117b8c29bba9d0310bb5dcf66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c20160117b8c29bba9d0310bb5dcf66">&#9670;&nbsp;</a></span>CdiPacketizerStateInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CdiPacketizerStateInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a>&#160;</td>
          <td class="paramname"><em>packetizer_state_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes a packetizer state object. This function should be called before calling <a class="el" href="payload_8h.html#afaef1dc8535f2f1dcddbd4ba0dd18b02">CdiPayloadGetPacket()</a> the first time for a given payload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetizer_state_handle</td><td>Handle of packetizer object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afaef1dc8535f2f1dcddbd4ba0dd18b02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaef1dc8535f2f1dcddbd4ba0dd18b02">&#9670;&nbsp;</a></span>CdiPayloadGetPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CdiPayloadGetPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="payload_8h.html#a06d161c2e2c9f4dddcf1634657b3e0b3">CdiPacketizerStateHandle</a>&#160;</td>
          <td class="paramname"><em>packetizer_state_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCdiCDIPacketHeaderUnion.html">CdiCDIPacketHeaderUnion</a> *&#160;</td>
          <td class="paramname"><em>hdr_union_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cdi__pool__api_8h.html#a8e5912d6ac4676dac0adfb54cada3e03">CdiPoolHandle</a>&#160;</td>
          <td class="paramname"><em>packet_sgl_entry_pool_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTxPayloadState.html">TxPayloadState</a> *&#160;</td>
          <td class="paramname"><em>payload_state_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCdiSgList.html">CdiSgList</a> *&#160;</td>
          <td class="paramname"><em>packet_sgl_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>ret_is_last_packet_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the next packet for a payload. Must use <a class="el" href="payload_8h.html#a3c20160117b8c29bba9d0310bb5dcf66">CdiPacketizerStateInit()</a> for a new payload before using this function. If false is returned, one of the pools from which required resources are taken is dry so this function should be called again until it returns true.</p>
<p>NOTE: All the pools used in this function are not thread-safe, so must ensure that only one thread is accessing them at a time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetizer_state_handle</td><td>///&lt; Handle of the packetizer state for this connection. </td></tr>
    <tr><td class="paramname">hdr_union_ptr</td><td>///&lt; Pointer to the header data structure to be filled in for the new packet. </td></tr>
    <tr><td class="paramname">packet_sgl_entry_pool_handle</td><td>///&lt; CDI packet SGL list entry pool. </td></tr>
    <tr><td class="paramname">payload_state_ptr</td><td>///&lt; Pointer to payload state data. </td></tr>
    <tr><td class="paramname">packet_sgl_ptr</td><td>///&lt; Pointer to returned packet SGL list </td></tr>
    <tr><td class="paramname">ret_is_last_packet_ptr</td><td>///&lt; Pointer to returned last packet state. True if last packet, otherwise false.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if packet returned, otherwise a pool was empty so false is returned. </dd></dl>

</div>
</div>
<a id="a6e09a3c16d4bbe498e66b10a66b7c4e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e09a3c16d4bbe498e66b10a66b7c4e2">&#9670;&nbsp;</a></span>CdiPayloadInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CdiPayloadInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCdiConnectionState.html">CdiConnectionState</a> *&#160;</td>
          <td class="paramname"><em>con_state_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structCdiSgList.html">CdiSgList</a> *&#160;</td>
          <td class="paramname"><em>source_sgl_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTxPayloadState.html">TxPayloadState</a> *&#160;</td>
          <td class="paramname"><em>payload_state_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize an <a class="el" href="structCdiPayloadCDIPacketState.html" title="Structure used to hold state data for a single payload. ">CdiPayloadCDIPacketState</a> structure before using <a class="el" href="payload_8h.html#afaef1dc8535f2f1dcddbd4ba0dd18b02">CdiPayloadGetPacket()</a> to split the payload into packets. NOTE: If an error occurs, caller is responsible for freeing the pool buffers that it allocates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">con_state_ptr</td><td>///&lt; Pointer to connection state data. </td></tr>
    <tr><td class="paramname">source_sgl_ptr</td><td>///&lt; Pointer to Tx Payload source SGL list. </td></tr>
    <tr><td class="paramname">payload_state_ptr</td><td>///&lt; Pointer to payload state data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful, otherwise an error occurred. </dd></dl>

</div>
</div>
<a id="a725e7ad79003354c13854e0c21e30767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a725e7ad79003354c13854e0c21e30767">&#9670;&nbsp;</a></span>CdiPayloadParseCDIPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structCdiCDIPacketCommonHeader.html">CdiCDIPacketCommonHeader</a>* CdiPayloadParseCDIPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structCdiSgList.html">CdiSgList</a> *&#160;</td>
          <td class="paramname"><em>packet_sgl_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the CDI common header of a CDI packet #0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet_sgl_ptr</td><td>Pointer to CDI packet SGL list.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CdiCDIPacketCommonHeader* Pointer to CDI packet common header. If NULL, then an error occurred. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
	<div>Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.</div>
</small></address>
</body>
</html>
